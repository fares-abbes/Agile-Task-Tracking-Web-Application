<div class="w-full h-full">
  <div class="bg-slate-900/80 rounded-lg p-4 h-full flex flex-col">
    <div class="flex items-center justify-between mb-3">
      <div class="text-sm text-slate-300 font-medium">Project Progress</div>
      <div class="flex gap-2">
        <button (click)="prev()" class="w-6 h-6 bg-slate-800 text-white rounded-full text-xs">‹</button>
        <button (click)="next()" class="w-6 h-6 bg-indigo-600 text-white rounded-full text-xs">›</button>
      </div>
    </div>

    <div class="text-center mb-2">
      <div class="text-xl font-bold text-white">{{ hasProjects ? (currentPercentage + '%') : '—' }}</div>
      <div class="text-xs text-slate-100">completion rate</div>
    </div>

    <!-- Chart container lifted up -->
    <div class="flex-1 flex items-start justify-center min-h-0 ">
      <div class="w-full max-w-sm h-40 -mt-20">
        <canvas #chartCanvas class="w-full h-full block"></canvas>
      </div>  
    </div>

    <!-- Project Info -->
    <div class="text-center mb-2">
      <div class="text-sm font-medium text-white">{{ currentProjectName || 'No Project Selected' }}</div>
      <div class="text-xs text-slate-300">{{ hasProjects ? projects[currentIndex].doneApprovedCount : 0 }} / {{ hasProjects ? projects[currentIndex].totalTasks : 0 }} tasks completed</div>
    </div>

    <!-- Legend -->
    <div class="flex justify-center gap-4 text-xs">
      <div class="flex items-center gap-1">
        <div class="w-2 h-2 bg-emerald-400 rounded-full"></div>
        <span class="text-slate-300">Completed</span>
      </div>
      <div class="flex items-center gap-1">
        <div class="w-2 h-2 bg-orange-400 rounded-full"></div>
        <span class="text-slate-300">In Progress</span>
      </div>
      <div class="flex items-center gap-1">
        <div class="w-2 h-2 bg-red-400 rounded-full"></div>
        <span class="text-slate-300">Pending</span>
      </div>
    </div>

    <!-- Loading/Error States -->
    <div *ngIf="loading" class="flex items-start justify-center flex-1 pt-4">
      <div class="text-center">
        <div class="w-4 h-4 border border-slate-600 border-t-white rounded-full animate-spin mx-auto mb-2"></div>
        <div class="text-slate-400 text-xs">Loading projects...</div>
      </div>
    </div>
    <div *ngIf="error" class="flex items-start justify-center flex-1 pt-4">
      <div class="text-red-400 text-xs">Failed to load data</div>
    </div>
    <div *ngIf="!loading && !error && !hasProjects" class="flex items-start justify-center flex-1 pt-4">
      <div class="text-slate-400 text-xs">No projects found</div>
    </div>
  </div>
</div>
